{% extends "base.html" %}

{% block title %}Logowanie{% endblock %}

{% block content %}
<h1>Zaloguj siÄ™</h1>

<div id="login-area">
    <button onclick="login()">ğŸ” Zaloguj siÄ™ przez Google</button>
</div>

<div id="user-info" style="display:none;">
    <p>Zalogowany jako: <span id="user-email"></span></p>
    <button onclick="logout()">ğŸšª Wyloguj siÄ™</button>
</div>

<script>
const provider = new firebase.auth.GoogleAuthProvider();

function login() {
    firebase.auth().signInWithPopup(provider)
        .then(result => {
            const user = result.user;
            document.getElementById("login-area").style.display = "none";
            document.getElementById("user-info").style.display = "block";
            document.getElementById("user-email").textContent = user.email;

            // (opcjonalnie) przekierowanie do dashboardu
            setTimeout(() => {
                window.location.href = "/"; 
            }, 1000);
        })
        .catch(error => {
            console.error(error);
            alert("Logowanie nie powiodÅ‚o siÄ™.");
        });
}

function logout() {
    firebase.auth().signOut().then(() => {
        document.getElementById("login-area").style.display = "block";
        document.getElementById("user-info").style.display = "none";
    });
}
</script>
{% endblock %}
